Code used in chapter 7
